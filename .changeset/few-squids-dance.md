---
"@wiggum/cli": minor
---

Add a workspace runner to Wiggum CLI with independent project graph calculation, including project listing/graph commands, graph-based execution ordering, filtering, concurrency controls, and dry-run JSON planning output. Runner failure flows now include richer AI remediation context (`--autofix`) and optional prompt generation (`--ai-prompt`) for failed project runs, with prompt fallback support in non-interactive environments. Runner flag parsing now rejects empty `--project` filters and invalid `WIGGUM_RUNNER_PARALLEL` / concurrency values with clear errors, while supporting `--project` and `-p` (including `-p=<pattern>`) aliases and allowing `run`/`projects` options before command tokens. Agent chat mode now clearly guards against non-interactive terminals, agent serve flags support long/equal/short forms (`--flag value`, `--flag=value`, `-p/-H`, `-p=<port>`, `-H=<host>`) plus a `--host` alias with strict validation, and passthrough flag forwarding is documented for overlapping global/tool flags.

Follow-up hardening includes stricter verifier script input contracts (safe integer bounds, filesystem/env path option validation, duplicate project root detection), runtime-resolved verifier environment overrides for isolated fixture/CI checks, and refined `--autofix` parsing so agent command arguments are preserved while runner/projects global guardrails remain explicit.

Additional runner graph hardening now broadens inferred dependency detection across static imports, dynamic imports, `require`/`require.resolve`/`import.meta.resolve` calls, and export-from specifiers (including scoped and unscoped subpath forms, plus commented import argument lists) while supporting `.mts`/`.cts` source scanning and deterministic capped-file traversal across `src/`, `test/`, `tests/`, `spec/`, `specs/`, and `__tests__/` directories. The `--no-infer-imports` control is now fully covered across `run`, `projects graph`, and `projects list` outputs.

Inference scan behavior is now tunable via `WIGGUM_RUNNER_INFER_IMPORT_MAX_FILES` (positive integer, default `400`) with explicit validation and mode-aware behavior across `run` and `projects` workflows (including fallback/ignore behavior when `--no-infer-imports` is enabled).

Runner config resolution now fails fast with deterministic diagnostics when unsupported TypeScript config variants (`wiggum.config.ts`, `.mts`, `.cts`) are used, while still preferring supported config files (`wiggum.config.json`, `.mjs`, `.js`, `.cjs`) when both are present.

Runner coverage verifier defaults are now aligned with runtime runner behavior by auto-detecting supported config files in runner precedence order, scoping defaults correctly to explicit verifier roots, and failing fast for unsupported TypeScript config overrides with explicit diagnostics.

Workflow verification has also been hardened to guard CI contract drift more aggressively: required package scripts now include `lint`, `typecheck`, and `ci:validate`, required workflow steps include publint + demo e2e gates, and tests now enforce deterministic per-job step ordering (with explicit job-scoped diagnostics) so accidental step reordering or fallback rewrites are caught immediately. Additional workflow content contracts now pin core triggers/job runtime metadata (target branches, ubuntu runners, Node 20 matrix/setup, and pnpm cache wiring in setup-node blocks). Required step matching is now explicitly job-scoped (so shared step names can be validated in multiple jobs) and enforces `pnpm install --frozen-lockfile` install gates in both `build-and-test` and `lint`; CI action wiring is also pinned per job (`actions/checkout@v4`, `pnpm/action-setup@v2`, and `actions/setup-node@v4`) to catch version drift early. Trigger branch validation now handles inline/multiline/quoted YAML key forms, required jobs are explicitly guarded from semantic `continue-on-error` truthy drift (including quoted keys/value variants), setup preflight steps are contract-pinned to deterministic order **and single-occurrence uniqueness** in both CI jobs, and verifier contract definitions (required scripts, required steps, and required content entries) now include explicit schema validation, non-empty contract-array guards, single-line command constraints, and uniqueness checks to prevent malformed/ambiguous rules from silently weakening checks. Runner graph resolution now also rejects duplicate `package.json` names across distinct explicit project entries to avoid ambiguous local dependency/import mapping, and local manifest graph links now resolve valid `npm:`/`workspace:` alias package targets, local `file:`/`link:`/`portal:` package paths, plus `bundleDependencies` / `bundledDependencies` entries so aliased or bundled workspace dependencies still enforce correct ordering without introducing malformed path-target edges.
